<!--
 * @Author: your name
 * @Date: 2021-12-08 11:44:49
 * @LastEditTime: 2021-12-09 16:27:02
 * @LastEditors: Please set LastEditors
 * @Description: æ‰“å¼€koroFileHeaderæŸ¥çœ‹é…ç½® è¿›è¡Œè®¾ç½®: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
 * @FilePath: /geek-visual-demo/math/demo3.html
-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å‚æ•°æ–¹ç¨‹æè¿°æ›²çº¿(å­¦ä¹ åç‰ˆæœ¬)</title>
  <style>
    * {
      margin: 0;
      padding: 0;
    }

    canvas {
      background-color: aliceblue;
    }
  </style>
</head>

<body>
  <div class="canvas-box">
    <canvas id="demo3" width="800" height="800"></canvas>
  </div>
  <script>
    const ANG_MAX = 2 * Math.PI;

    const canvas = document.getElementById('demo3');
    const ctx = canvas.getContext('2d');
    const {width, height} = canvas;
    const w = 0.5 * width, h = 0.5 * height;
    // ä¸­å¿ƒç‚¹æ˜¯åŸç‚¹
    ctx.translate(w, h);
    // åæ ‡ç³»æˆå¸¸è§„æ•°å­¦åæ ‡ç³»ï¼ˆæœ‰æ–‡å­—ä¸å¯ä»¥ğŸ™…â€â™‚ï¸ï¼‰
    ctx.scale(1, -1);

    // æ ¹æ®ç‚¹æ¥ç»˜åˆ¶å›¾å½¢
    function draw(points, ctx, {
      clear = true,
      strokeStyle = 'black',
      fillStyle = null,
      close = false,
      startDraw = false
    } = {}) {
      const { canvas } = ctx;
      if (clear) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
      }

      
      ctx.strokeStyle = strokeStyle;
      if (startDraw) {
        ctx.beginPath();
        ctx.arc(...points[0], 5, 0, 2 * Math.PI);
        ctx.fill();
      }

      ctx.beginPath();
      ctx.moveTo(...points[0]);
      for (let i = 1; i < points.length; i++) {
        ctx.lineTo(...points[i]);
      }
      if (close) ctx.closePath();
      if (fillStyle) {
        ctx.fillStyle = fillStyle;
        ctx.fill();
      }
      ctx.stroke();
    }

    /**
     * @description: æ ¹æ®ä¸åŒçš„å‚æ•°æ–¹ç¨‹è·å–ç»˜åˆ¶å…¶ç‚¹åæ ‡çš„å‡½æ•°
     * @param {*} xFunc
     * @param {*} yFunc
     * @return {*}
     */    
    function parametric(xFunc, yFunc) {
      /**
       * @description: æ‰€å±æ›²çº¿å‚æ•°æ–¹ç¨‹ç»˜åˆ¶ç‚¹åæ ‡è·å–
       * @param {*} åœ†æˆ–è€…æ¤­åœ†ç­‰ï¼šèµ·å§‹å¼§åº¦ï¼›æŠ›ç‰©çº¿ç­‰ï¼šçº¿æ€§å˜åŒ–èŒƒå›´ï¼ˆå…³é”®æ˜¯è¦è·å–å‚æ•°æ–¹ç¨‹å˜åŒ–çš„èŒƒå›´æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå¯¹åº”çš„è§„åˆ™å’Œå˜åŒ–èŒƒå›´ä¹‹é—´çš„å…³ç³»ï¼‰
       * @return {*}åœ†æˆ–è€…æ¤­åœ†ç­‰ï¼šç»ˆç‚¹å¼§åº¦ï¼›æŠ›ç‰©çº¿ç­‰ï¼šçº¿æ€§å˜åŒ–èŒƒå›´
       */      
      return (start, end, seg = 100, ...args) => {
        const points = [];

        for(let i = 0; i <= seg; i++) {
          // ä¸¤æ•°ä¹‹é—´çš„çº¿æ€§å¢é•¿ï¼ˆçº¿æ€§æ’å€¼ï¼‰  https://zh.wikipedia.org/wiki/%E7%BA%BF%E6%80%A7%E6%8F%92%E5%80%BC
          // æ¯”å¦‚è¯´åœ†çš„ï¼ˆ0, 2 * Math.PIï¼‰ã€ï¼ˆMath.PI / 3, Math.PIï¼‰ç­‰
          // æ¯”å¦‚è¯´å¼§çº¿çš„ [-5, 5][0,5]ç­‰
          const length = end - start;
          const t = start + (length / seg) * i;

          const x = xFunc(t, ...args);
          const y = yFunc(t, ...args);
          points.push([x, y])
        }
        return points;
      }
    }

    // æŠ›ç‰©çº¿å‡½æ•°
    const paraFunc = parametric(
      (t, x0, y0, p) => {
        return x0 + 2 * p * t ** 2;
      },
      (t, x0, y0, p) => {
        return y0 + 2 * p * t;
      }
    );
    // é¡¶ç‚¹åæ ‡ (0, 0)
    const paraPoints = paraFunc(-3.5, 3.5, 100, 0, 0, 10);
    console.log('paraPoints', paraPoints);
    draw(paraPoints, ctx, {
      strokeStyle: 'purple'
    });

    
    // åœ†å‚æ•°æ–¹ç¨‹
    const circleFunc = parametric(
      (rad, x0, y0, r) => {
        return x0 + r * Math.cos(rad);
      },
      (rad, x0, y0, r) => {
        return y0 + r * Math.sin(rad);
      }
    );
    // åœ†å¿ƒåæ ‡ (0,0)
    const circlePoints = circleFunc(0, 2 * Math.PI, 100, 0, 0, 50);
    console.log('circlePoints', circlePoints);
    draw(circlePoints, ctx, {
      clear: false,
      close: true,
      strokeStyle: 'green'
    });

    // æ¤­åœ†å‚æ•°æ–¹ç¨‹
    const ellipseFunc = parametric(
      (rad, x0, y0, long, short) => {
        return x0 + long * Math.cos(rad);
      },
      (rad, x0, y0, long, short) => {
        return y0 + short * Math.sin(rad);
      }
    );

    // ä¸­å¿ƒç‚¹åæ ‡ (0, 0)
    const ellipsePoints = ellipseFunc(0, 2 * Math.PI, 100, 0, 0, 100, 50);
    console.log('ellipsePoints', ellipsePoints);
    draw(ellipsePoints, ctx, {
      clear: false,
      close: true,
      strokeStyle: 'red'
    });

    // æ˜Ÿçº¿
    const starFunc = parametric(
      (rad, l) => l * Math.cos(rad) ** 3,
      (rad, l) => l * Math.sin(rad) ** 3,
    );

    const starPoints = starFunc(0, Math.PI * 2, 50, 250);
    console.log('starPoints', starPoints);
    draw(starPoints, ctx, {
      close: true,
      clear: false,
      strokeStyle: 'blue'
    })    

    // é˜¿åŸºç±³å¾·èºæ—‹çº¿
    const helicalFunc = parametric(
      (t, l) => l * t * Math.cos(t),
      (t, l) => l * t * Math.sin(t),
    );

    const helicalPoints = helicalFunc(0, 50, 500, 3);
    console.log('helicalPoints', helicalPoints);
    draw(helicalPoints, ctx, {
      close: false,
      clear: false,
      strokeStyle: 'pink'
    }) 


  </script>
</body>

</html>